┌──────────────────────────────────────────────────────────────────────────────────────────────┐
│                     arcforge Skill 載入流程 (Skill Loading by Platform)                   │
├──────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                              │
│  1. OVERVIEW - 平台比較總覽                                                                   │
│  ═══════════════════════════════════════════════════════════════════════════════════════════ │
│                                                                                              │
│  ┌─────────────────┬─────────────────┬─────────────────┬─────────────────┬─────────────────┐ │
│  │ 特性            │ Claude Code     │ Codex           │ Gemini CLI      │ OpenCode        │ │
│  ├─────────────────┼─────────────────┼─────────────────┼─────────────────┼─────────────────┤ │
│  │ 載入方式        │ 原生 Plugin     │ Symlink         │ Symlink         │ System Transform│ │
│  │ 層級數          │ 1 (內建)        │ 2 層            │ 3 層            │ 3 層            │ │
│  │ 自動注入        │ ✓ (啟動時)      │ ✓ (原生發現)    │ ✓ (原生發現)    │ ✓ (系統轉換)    │ │
│  │ 需要 Node.js    │ ✗               │ ✗               │ ✗               │ ✓               │ │
│  │ Bootstrap 方式  │ Plugin 系統     │ Symlink         │ Symlink         │ system.transform│ │
│  └─────────────────┴─────────────────┴─────────────────┴─────────────────┴─────────────────┘ │
│                                                                                              │
├──────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                              │
│  2. CLAUDE CODE - 原生 Plugin 系統                                                            │
│  ═══════════════════════════════════════════════════════════════════════════════════════════ │
│                                                                                              │
│  安裝路徑:                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │  ~/.claude/plugins/arcforge/          # Plugin 安裝位置                          │    │
│  │  ├── .claude-plugin/                                                                │    │
│  │  │   └── plugin.json                      # Plugin 元資料                            │    │
│  │  ├── .claude/skills/                      # Skill symlinks                          │    │
│  │  │   ├── arc-brainstorming → ../../skills/arc-brainstorming                       │    │
│  │  │   ├── arc-debugging → ../../skills/arc-debugging                                 │    │
│  │  │   └── ...                                                                        │    │
│  │  └── skills/                              # 實際 skill 檔案                          │    │
│  │      ├── arc-using/SKILL.md                                                     │    │
│  │      ├── arc-brainstorming/SKILL.md                                                │    │
│  │      └── ...                                                                        │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  載入流程:                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                                                                     │    │
│  │   ┌───────────────────┐                                                             │    │
│  │   │  Claude Code 啟動  │                                                             │    │
│  │   └─────────┬─────────┘                                                             │    │
│  │             │                                                                       │    │
│  │             ▼                                                                       │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  Plugin System 掃描 ~/.claude/plugins/                                    │    │    │
│  │   │  讀取 .claude-plugin/plugin.json                                          │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  自動載入 .claude/skills/ 下的 symlinks                                    │    │    │
│  │   │  解析每個 SKILL.md 的 frontmatter                                          │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  Skills 註冊為 /arcforge:<skill-name> 指令                             │    │    │
│  │   │  可透過 /help 或 Skill tool 呼叫                                           │    │    │
│  │   └───────────────────────────────────────────────────────────────────────────┘    │    │
│  │                                                                                     │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  使用方式:                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │  # 安裝 plugin                                                                      │    │
│  │  /plugin marketplace add arcforge                                               │    │
│  │  /plugin install arcforge@arcforge                                          │    │
│  │                                                                                     │    │
│  │  # 使用 skill                                                                       │    │
│  │  /arcforge:arc-brainstorming    # 透過 slash command                           │    │
│  │  Skill tool → skill: "arc-brainstorming"   # 透過 Skill tool                       │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
├──────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                              │
│  3. CODEX - Symlink + 原生 Skill Discovery                                                   │
│  ═══════════════════════════════════════════════════════════════════════════════════════════ │
│                                                                                              │
│  安裝路徑:                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │  ~/.codex/                                                                          │    │
│  │  ├── arcforge/                        # Clone 的 repo                           │    │
│  │  │   ├── .codex/                                                                    │    │
│  │  │   │   ├── arcforge-codex           # Node.js CLI script                      │    │
│  │  │   │   ├── arcforge-bootstrap.md    # Bootstrap 內容                          │    │
│  │  │   │   └── INSTALL.md                   # 安裝說明                                │    │
│  │  │   └── skills/                          # Skill 檔案                              │    │
│  │  ├── skills/                              # Personal skills (覆蓋用)                │    │
│  │  └── AGENTS.md                            # Bootstrap 注入點                        │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  Skill 優先順序 (2 層):                                                                       │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                                                                     │    │
│  │   優先級 1 (最高)          優先級 2 (最低)                                           │    │
│  │   ┌─────────────────┐      ┌─────────────────┐                                      │    │
│  │   │ Personal Skills │  >   │ Agentic Skills  │                                      │    │
│  │   │ ~/.codex/skills │      │ ~/.codex/       │                                      │    │
│  │   │                 │      │ arcforge/   │                                      │    │
│  │   │ 命名: skill-name│      │ skills/         │                                      │    │
│  │   │ (無前綴)        │      │                 │                                      │    │
│  │   └─────────────────┘      │ 命名: agentic-  │                                      │    │
│  │                            │ core:skill-name │                                      │    │
│  │                            └─────────────────┘                                      │    │
│  │                                                                                     │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  載入流程:                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                                                                     │    │
│  │   ┌───────────────────┐                                                             │    │
│  │   │   Codex 啟動       │                                                             │    │
│  │   └─────────┬─────────┘                                                             │    │
│  │             │                                                                       │    │
│  │             ▼                                                                       │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  讀取 ~/.codex/AGENTS.md (系統提示)                                        │    │    │
│  │   │  內含 bootstrap 內容 + <EXTREMELY_IMPORTANT> 標籤                          │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  Agent 收到 skill 請求                                                     │    │    │
│  │   │  (使用者說 "/arc-brainstorming" 或透過 bootstrap 引導)                    │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  Agent 執行 CLI script:                                                    │    │    │
│  │   │  ~/.codex/arcforge/.codex/arcforge-codex use-skill <name>          │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  CLI 解析 skill name:                                                      │    │    │
│  │   │  1. 檢查 ~/.codex/skills/<name>/SKILL.md (personal)                        │    │    │
│  │   │  2. 檢查 ~/.codex/arcforge/skills/<name>/SKILL.md (agentic)            │    │    │
│  │   │  3. 解析 frontmatter, 移除後輸出 skill 內容                                 │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  Skill 內容輸出到 stdout → Agent 讀取並遵循                                │    │    │
│  │   └───────────────────────────────────────────────────────────────────────────┘    │    │
│  │                                                                                     │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  CLI 指令:                                                                                   │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │  ~/.codex/arcforge/.codex/arcforge-codex bootstrap     # 輸出完整 bootstrap │    │
│  │  ~/.codex/arcforge/.codex/arcforge-codex find-skills   # 列出所有 skills    │    │
│  │  ~/.codex/arcforge/.codex/arcforge-codex use-skill <n> # 載入指定 skill     │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
├──────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                              │
│  4. GEMINI CLI - Symlink + 原生 Skill Discovery (3 層)                                       │
│  ═══════════════════════════════════════════════════════════════════════════════════════════ │
│                                                                                              │
│  安裝路徑:                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │  ~/.gemini/                                                                         │    │
│  │  ├── arcforge/                        # Clone 的 repo                           │    │
│  │  │   ├── .gemini/                                                                   │    │
│  │  │   │   ├── arcforge-gemini          # Node.js CLI script                      │    │
│  │  │   │   ├── arcforge-bootstrap.md    # Bootstrap 內容                          │    │
│  │  │   │   └── INSTALL.md                   # 安裝說明                                │    │
│  │  │   └── skills/                          # Skill 檔案                              │    │
│  │  ├── skills/                              # User skills (覆蓋用)                    │    │
│  │  └── GEMINI.md                            # Bootstrap 注入點                        │    │
│  │                                                                                     │    │
│  │  <project>/.gemini/skills/                # Workspace skills (最高優先級)           │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  Skill 優先順序 (3 層):                                                                       │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                                                                     │    │
│  │   優先級 1 (最高)      優先級 2              優先級 3 (最低)                         │    │
│  │   ┌──────────────┐    ┌──────────────┐      ┌──────────────┐                        │    │
│  │   │ Workspace    │ >  │ User Skills  │  >   │ Agentic      │                        │    │
│  │   │ Skills       │    │              │      │ Skills       │                        │    │
│  │   │ .gemini/     │    │ ~/.gemini/   │      │ ~/.gemini/   │                        │    │
│  │   │ skills/      │    │ skills/      │      │ arcforge/│                        │    │
│  │   │              │    │              │      │ skills/      │                        │    │
│  │   │ workspace:   │    │ skill-name   │      │ arcforge:│                        │    │
│  │   │ skill-name   │    │ (無前綴)     │      │ skill-name   │                        │    │
│  │   └──────────────┘    └──────────────┘      └──────────────┘                        │    │
│  │                                                                                     │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  載入流程 (與 Codex 相似，但多一層):                                                          │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                                                                     │    │
│  │   ┌───────────────────┐                                                             │    │
│  │   │   Gemini CLI 啟動  │                                                             │    │
│  │   └─────────┬─────────┘                                                             │    │
│  │             │                                                                       │    │
│  │             ▼                                                                       │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  讀取 ~/.gemini/GEMINI.md (系統提示)                                       │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  Agent 執行 CLI: arcforge-gemini use-skill <name>                      │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  CLI 解析 skill name (3 層搜尋):                                           │    │    │
│  │   │  1. .gemini/skills/<name>/SKILL.md (workspace)                             │    │    │
│  │   │  2. ~/.gemini/skills/<name>/SKILL.md (user)                                │    │    │
│  │   │  3. ~/.gemini/arcforge/skills/<name>/SKILL.md (agentic)                │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  輸出 skill 內容 (移除 frontmatter)                                        │    │    │
│  │   └───────────────────────────────────────────────────────────────────────────┘    │    │
│  │                                                                                     │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  與 Codex 的關鍵差異:                                                                         │
│  • 多一層 Workspace skills (.gemini/skills/) 用於專案特定覆蓋                                 │
│  • 支援 workspace: 前綴強制使用專案層級 skill                                                 │
│                                                                                              │
├──────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                              │
│  5. OPENCODE - System Transform + Symlink                                                    │
│  ═══════════════════════════════════════════════════════════════════════════════════════════ │
│                                                                                              │
│  安裝路徑:                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │  ~/.config/opencode/                                                                │    │
│  │  ├── arcforge/                        # Clone 的 repo                           │    │
│  │  │   ├── .opencode/                                                                 │    │
│  │  │   │   ├── plugin/                                                                │    │
│  │  │   │   │   └── arcforge.js          # ES6 Plugin module                       │    │
│  │  │   │   └── INSTALL.md                   # 安裝說明                                │    │
│  │  │   └── skills/                          # Skill 檔案                              │    │
│  │  ├── plugin/                                                                        │    │
│  │  │   └── arcforge.js → ...            # Symlink to plugin                       │    │
│  │  └── skills/                              # Personal skills                         │    │
│  │                                                                                     │    │
│  │  <project>/.opencode/skills/              # Project skills (最高優先級)             │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  Skill 優先順序 (3 層):                                                                       │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                                                                     │    │
│  │   優先級 1 (最高)      優先級 2              優先級 3 (最低)                         │    │
│  │   ┌──────────────┐    ┌──────────────┐      ┌──────────────┐                        │    │
│  │   │ Project      │ >  │ Personal     │  >   │ Agentic      │                        │    │
│  │   │ Skills       │    │ Skills       │      │ Skills       │                        │    │
│  │   │ .opencode/   │    │ ~/.config/   │      │ ~/.config/   │                        │    │
│  │   │ skills/      │    │ opencode/    │      │ opencode/    │                        │    │
│  │   │              │    │ skills/      │      │ arcforge/│                        │    │
│  │   │ project:     │    │              │      │ skills/      │                        │    │
│  │   │ skill-name   │    │ skill-name   │      │ arcforge:│                        │    │
│  │   └──────────────┘    └──────────────┘      │ skill-name   │                        │    │
│  │                                             └──────────────┘                        │    │
│  │                                                                                     │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  載入流程 (自動注入):                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                                                                     │    │
│  │   ┌───────────────────┐                                                             │    │
│  │   │   OpenCode 啟動    │                                                             │    │
│  │   └─────────┬─────────┘                                                             │    │
│  │             │                                                                       │    │
│  │             ▼                                                                       │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  載入 ~/.config/opencode/plugin/*.js                                       │    │    │
│  │   │  註冊 arcforge.js plugin                                               │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  Plugin 註冊 tools:                                                        │    │    │
│  │   │  • tool.use_skill - 載入指定 skill                                         │    │    │
│  │   │  • tool.find_skills - 列出所有 skills                                      │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  session.created 事件觸發                                                  │    │    │
│  │   │  ┌─────────────────────────────────────────────────────────────────────┐  │    │    │
│  │   │  │  自動注入:                                                          │  │    │    │
│  │   │  │  • Bootstrap 內容 (tool mappings)                                   │  │    │    │
│  │   │  │  • arc-using skill 完整內容                                     │  │    │    │
│  │   │  │  • 透過 client.session.prompt({ noReply: true })                    │  │    │    │
│  │   │  └─────────────────────────────────────────────────────────────────────┘  │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  (長對話時) session.compacted 事件觸發                                     │    │    │
│  │   │  ┌─────────────────────────────────────────────────────────────────────┐  │    │    │
│  │   │  │  重新注入精簡版 bootstrap                                            │  │    │    │
│  │   │  │  防止 context 壓縮後遺失 skill 資訊                                  │  │    │    │
│  │   │  └─────────────────────────────────────────────────────────────────────┘  │    │    │
│  │   └─────────────────────────────────┬─────────────────────────────────────────┘    │    │
│  │                                     │                                              │    │
│  │                                     ▼                                              │    │
│  │   ┌───────────────────────────────────────────────────────────────────────────┐    │    │
│  │   │  Agent 使用 use_skill tool 載入其他 skills                                 │    │    │
│  │   └───────────────────────────────────────────────────────────────────────────┘    │    │
│  │                                                                                     │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  Plugin 架構:                                                                                │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │  // arcforge.js (ES6 module)                                                    │    │
│  │  export default {                                                                   │    │
│  │    tool: {                                                                          │    │
│  │      use_skill: {                                                                   │    │
│  │        description: "Load a skill by name",                                         │    │
│  │        parameters: { skill_name: { type: "string" } },                              │    │
│  │        execute: async ({ skill_name }) => { ... }                                   │    │
│  │      },                                                                             │    │
│  │      find_skills: {                                                                 │    │
│  │        description: "List all available skills",                                    │    │
│  │        execute: async () => { ... }                                                 │    │
│  │      }                                                                              │    │
│  │    },                                                                               │    │
│  │    hook: {                                                                          │    │
│  │      "session.created": async (client) => {                                         │    │
│  │        // Auto-inject bootstrap + arc-using                                     │    │
│  │        await client.session.prompt({ content: "...", noReply: true });              │    │
│  │      },                                                                             │    │
│  │      "session.compacted": async (client) => {                                       │    │
│  │        // Re-inject compact bootstrap                                               │    │
│  │      }                                                                              │    │
│  │    }                                                                                │    │
│  │  }                                                                                  │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  與其他平台的關鍵差異:                                                                        │
│  • 使用 Plugin API 而非 CLI script                                                           │
│  • 自動注入 bootstrap (不需手動編輯設定檔)                                                    │
│  • 支援 session.compacted 重新注入 (長對話保護)                                               │
│  • noReply: true 讓注入訊息不觸發回應                                                        │
│                                                                                              │
├──────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                              │
│  7. SKILL.md 檔案格式                                                                        │
│  ═══════════════════════════════════════════════════════════════════════════════════════════ │
│                                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │  ---                                                                                │    │
│  │  name: arc-brainstorming                                                           │    │
│  │  description: Use when exploring ideas before implementation or when user says...   │    │
│  │  ---                                                                                │    │
│  │                                                                                     │    │
│  │  # arc-brainstorming                                                               │    │
│  │                                                                                     │    │
│  │  ## Overview                                                                        │    │
│  │  [Skill content...]                                                                 │    │
│  │                                                                                     │    │
│  │  ## Workflow                                                                        │    │
│  │  [Steps...]                                                                         │    │
│  │                                                                                     │    │
│  │  ✅ Done when: [completion criteria]                                                │    │
│  │  ⚠️ Blocked: [blocked criteria]                                                     │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                              │
│  規範:                                                                                       │
│  • name: 必須與目錄名稱相符                                                                  │
│  • description: 必須以 "Use when..." 開頭 (僅描述觸發條件，非流程摘要)                        │
│  • frontmatter 總長度 < 1024 字元                                                            │
│  • Skill 內容 < 650 字 (pipeline skills)                                                     │
│                                                                                              │
└──────────────────────────────────────────────────────────────────────────────────────────────┘
